CONTAINER_REGISTRY ?= ghcr.io
NAMESPACE ?= vchokshi
APPLICATION_NAME ?= leza-rtl
GIT_HASH ?= $(shell git log --format="%h" -n 1)

build:
	docker build --tag ${CONTAINER_REGISTRY}/${NAMESPACE}/${APPLICATION_NAME}:${GIT_HASH} .
push:
	docker push ${CONTAINER_REGISTRY}/${NAMESPACE}/${APPLICATION_NAME}:${GIT_HASH}
run:
	docker run -p 3000:3000 ${DOCKER_USERNAME}/${APPLICATION_NAME}

release:
	docker pull ${CONTAINER_REGISTRY}/${NAMESPACE}/${APPLICATION_NAME}:${GIT_HASH}
	docker tag ${CONTAINER_REGISTRY}/${NAMESPACE}/${APPLICATION_NAME}:${GIT_HASH} ${CONTAINER_REGISTRY}/${NAMESPACE}/${APPLICATION_NAME}:latest
	docker push ${CONTAINER_REGISTRY}/${NAMESPACE}/${APPLICATION_NAME}:latest
